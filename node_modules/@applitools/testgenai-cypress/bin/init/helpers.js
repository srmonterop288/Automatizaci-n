"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createDirectory = exports.addImport = exports.isCommonJSImport = void 0;
const isCommonJSImport = (sourceFile) => {
    const imports = sourceFile.getImportDeclarations();
    return imports.length === 0;
};
exports.isCommonJSImport = isCommonJSImport;
const addImport = (sourceFile, importDeclaration) => {
    let hasNamedImport = importDeclaration.namedImports !== undefined;
    if ((0, exports.isCommonJSImport)(sourceFile)) {
        const isStatementExists = sourceFile.getStatements().some(statement => statement.getText().includes(importDeclaration.moduleSpecifier));
        if (isStatementExists)
            return;
        let statement = '';
        if (hasNamedImport) {
            statement = `const { ${importDeclaration.namedImports.join(', ')} } = require('${importDeclaration.moduleSpecifier}')`;
        }
        else {
            statement = `require('${importDeclaration.moduleSpecifier}')`;
        }
        sourceFile.insertStatements(0, [statement]);
    }
    else {
        const isImportExists = sourceFile.getImportDeclarations().some(declaration => declaration.getModuleSpecifierValue() === importDeclaration.moduleSpecifier);
        if (isImportExists)
            return;
        sourceFile.addImportDeclaration(importDeclaration);
    }
};
exports.addImport = addImport;
const createDirectory = (directoryPath) => {
    const fs = require('fs');
    if (!fs.existsSync(directoryPath)) {
        fs.mkdirSync(directoryPath, { recursive: true });
    }
};
exports.createDirectory = createDirectory;
